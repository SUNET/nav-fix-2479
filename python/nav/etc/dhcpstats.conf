# This file contains the configuration for collection of stats from DHCP servers.
# For NAV to collect stats from a DHCP server, an endpoint that serves such
# statistics (e.g. the DHCP server itself or an external API endpoint) must be
# set up and then configured as an endpoint in this config file.
#
# Any section whose name starts with the endpoint_
# prefix defines a new endpoint configuration:
#
# [endpoint_foo] <--- This section configures an endpoint with identifier 'foo'
# type=dnsmasq <--- This option tells us it's a dnsmasq endpoint
# url=https://url.to.dnsmasq.server/ <--- This option tells us where the endpoint is located
#
# [foo] <--- This section does *not* configure an endpoint
# type=dnsmasq
# url=https://url.to.dnsmasq.api.endpoint/
#
# Note that section names are used when storing data for endpoints into the
# Carbon timeseries backend, and as such it *should* only contain english
# letters, digits, underscores, and hyphens. Any other character is replaced by
# an underscore, which at best causes some confusion and at worst causes
# unrelated endpoints to be treated as the same endpoint in the timeseries
# database.


# The remainder of this commentary documents how to configure the
# various types of endpoints that is supported:


# Configuring collection of stats from 'kea-dhcp4' endpoints
# ==========================================================
#
# Mandatory options
# -----------------
# * The 'type' option, specifying what type of endpoint is being configured. Its
#   value must be set to 'kea-dhcp4'.
#
# * The 'url' option, specifying where the endpoint is located. The url's scheme
#   must be 'http' or 'https'. Sensitive data (such as passwords) that might be
#   stored in the Kea DHCPv4 server's configuration is transmitted during
#   correspondence, so using 'https' is highly recommended. As a sidenote, such
#   possibly sensitive data is also temporarily stored in the memory of a NAV
#   process.
#
# Optional options
# ----------------
# * The 'timeout' optional option, specifying how long in seconds the client
#   should wait for an HTTP response from the endpoint before timing
#   out. Defaults to 5.0.
#
# * The 'http_basic_username' and 'http_basic_password' optional options. When
#   both of these options are set, HTTP Basic Authentication will be used in
#   communication with the endpoint.
#
# * The 'client_cert_path' optional option, specifying the path to a client-side
#   certificate.  When this option is set, the certificate will be used to
#   authenticate to the endpoint in TLS connections. If the
#   'client_cert_key_path' option (described below) is not set, it is assumed
#   that the certificate also contains the client private key necessary to
#   authenticate the client.
#
# * The 'client_cert_key_path' optional option, specifying the path to the
#   client private key to be used alongside the client certificate to
#   authenticate the client.
#
# * The 'user_context_poolname_key' optional option, specifying how NAV finds
#   the name of a Kea DHCPv4 address pool. On the server-side each Kea DHCPv4
#   address pool is configured as a JSON object with a mandatory 'pool' key and
#   an optional 'user-context' key holding an arbitrary JSON object. The
#   'user_context_poolname_key' option specifies which key in this
#   'user-context' object NAV will look up to find the name of a Kea DHCPv4
#   address pool. By default, NAV will look for the 'name' key. Example:
#
#     If 'user_context_poolname_key' has been set to 'custom-poolname' for a Kea
#     DHCPv4 server with the following configuration:
#
#     {
#       "Dhcp4": {
#         "subnet4": [
#           {
#             "subnet":  "172.31.255.0/24",
#             "pools": [
#               {
#                 "pool": "172.31.255.0/25",
#                  "user-context": {
#                    "custom-poolname": "oslo-staff"
#                  }
#               }
#             ],
#             "id": 1,
#             "interface": "eth0"
#           }
#         ]
#       }
#     }
#
#     Then NAV will associate with the address pool '172.31.255.0/25' the name
#     'oslo-staff'. Note that the name of a Kea DHCPv4 address pool *should*
#     only contain english letters, digits, underscores, and hyphens as it
#     will be stored into the Carbon timeseries backend.
#
#
# Example 'kea-dhcp4' configuration
# ---------------------
# [endpoint_example_1]
# type=kea-dhcp4
# url=https://example.org:8080/
# timeout=5.0
# http_basic_username=nav
# http_basic_password=cfcc3475c4de4f0484a4a475ec0a6edd
# client_cert_path=/etc/client.cert
# client_cert_key_path=/etc/client.key
# user_context_poolname_key=name
